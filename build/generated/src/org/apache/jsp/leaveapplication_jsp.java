package org.apache.jsp;

import javax.servlet.*;
import javax.servlet.http.*;
import javax.servlet.jsp.*;
import org.evamay.business.Staff;
import java.sql.*;

public final class leaveapplication_jsp extends org.apache.jasper.runtime.HttpJspBase
    implements org.apache.jasper.runtime.JspSourceDependent {

  private static final JspFactory _jspxFactory = JspFactory.getDefaultFactory();

  private static java.util.List<String> _jspx_dependants;

  private org.glassfish.jsp.api.ResourceInjector _jspx_resourceInjector;

  public java.util.List<String> getDependants() {
    return _jspx_dependants;
  }

  public void _jspService(HttpServletRequest request, HttpServletResponse response)
        throws java.io.IOException, ServletException {

    PageContext pageContext = null;
    HttpSession session = null;
    ServletContext application = null;
    ServletConfig config = null;
    JspWriter out = null;
    Object page = this;
    JspWriter _jspx_out = null;
    PageContext _jspx_page_context = null;

    try {
      response.setContentType("text/html;charset=UTF-8");
      pageContext = _jspxFactory.getPageContext(this, request, response,
      			null, true, 8192, true);
      _jspx_page_context = pageContext;
      application = pageContext.getServletContext();
      config = pageContext.getServletConfig();
      session = pageContext.getSession();
      out = pageContext.getOut();
      _jspx_out = out;
      _jspx_resourceInjector = (org.glassfish.jsp.api.ResourceInjector) application.getAttribute("com.sun.appserv.jsp.resource.injector");

      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("<!DOCTYPE html>\r\n");
      out.write("<html lang=\"en\">\r\n");
      out.write("    <head>\r\n");
      out.write("\t<title>EvaMay Technologies</title>\r\n");
      out.write("\t<meta charset=\"UTF-8\">\r\n");
      out.write("\t<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\t\r\n");
      out.write("\t<link rel=\"icon\" type=\"image/png\" href=\"images/logo2.png\"/>\r\n");
      out.write("\t\r\n");
      out.write("\t<link rel=\"stylesheet\" type=\"text/css\" href=\"css/util.css\">\r\n");
      out.write("\t<link rel=\"stylesheet\" type=\"text/css\" href=\"css/main.css\">\r\n");
      out.write("        <script src=\"js/jquery-3.5.1.js\"></script>\r\n");
      out.write("        <script src=\"js/jquery-ui.js\"></script>\r\n");
      out.write("\r\n");
      out.write("            <style>\r\n");
      out.write(".hide {\r\n");
      out.write("  display: none\r\n");
      out.write("}\r\n");
      out.write("</style>\r\n");
      out.write("    </head>\r\n");
      out.write("\r\n");
      out.write("    <body>\r\n");
      out.write("        \r\n");
      out.write("\t<div class=\"limiter\">\r\n");
      out.write("            <div class=\"container-login100\" style=\"background-image: url('images/office2.jpg');\">\r\n");
      out.write("\t\t<div class=\"wrap-login100\">\r\n");
      out.write("                    <form class=\"login100-form validate-form\" method=\"post\" action=\"ApplyLeaveServlet\" name=\"login_form\" id=\"login_form\">\r\n");
      out.write("\t\t\t<span class=\"login100-form-logo\">\r\n");
      out.write("                            <img src='images/logo2.png' alt='logo' width=\"200%\" height=\"100%\">\r\n");
      out.write("\t\t\t</span>\r\n");
      out.write("                        <span class=\"login100-form-title p-b-34 p-t-27\">\r\n");
      out.write("                            Leave application\r\n");
      out.write("\t\t\t</span>\r\n");
      out.write("                        \r\n");
      out.write("                        <div class=\"login100-form\">\r\n");
      out.write("                         <input type=\"hidden\" name=\"staffId\" id=\"staffId\" value=\"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.evaluateExpression("${staff.staffId}", java.lang.String.class, (PageContext)_jspx_page_context, null));
      out.write("\">\r\n");
      out.write("                         <input type=\"hidden\" name=\"status\" id=\"status\" value=\"pending\">  \r\n");
      out.write("                         <input type=\"hidden\" name=\"remainingDays\" id=\"remainingDays\" value=\"10\">\r\n");
      out.write("                         <input type=\"hidden\" name=\"gender\" id=\"gender\" value=\"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.evaluateExpression("${staff.gender}", java.lang.String.class, (PageContext)_jspx_page_context, null));
      out.write("\">\r\n");
      out.write("                        </div> \r\n");
      out.write("                        ");

            Staff staff=(Staff)session.getAttribute("staff");
            String gender=staff.getGender();
            String gender1="Male";
            System.out.println(staff.getGender());
            System.out.println(gender);
            System.out.println(gender1);
            if(gender.equals(gender1)){
            
      out.write("\r\n");
      out.write("\t\t\t<div class=\"login100-form\">\r\n");
      out.write("                            <label for=\"leaveType\">Leave Type:</label>\r\n");
      out.write("                            <select class=\"input100\" id=\"leaveType\" name=\"leaveType\">\r\n");
      out.write("                                <option>Annual</option>\r\n");
      out.write("                                <option>Sick</option>\r\n");
      out.write("                                <option>Paternity</option>\r\n");
      out.write("                                <option>Others</option>\r\n");
      out.write("                            </select>\r\n");
      out.write("                        </div>\r\n");
      out.write("            ");

            }else{
              
      out.write(" \r\n");
      out.write("              <div class=\"login100-form\">\r\n");
      out.write("                  \r\n");
      out.write("                            <label for=\"leaveType\">Leave Type:</label>\r\n");
      out.write("                            <select class=\"input100\" id=\"leaveType\" name=\"leaveType\">\r\n");
      out.write("                                <option>Annual</option>\r\n");
      out.write("                                <option>Sick</option>\r\n");
      out.write("                                <option>Maternity</option>\r\n");
      out.write("                                <option>Others</option>\r\n");
      out.write("                            </select>\r\n");
      out.write("                        </div>\r\n");
      out.write("               ");

            }
              
      out.write("  \r\n");
      out.write("                        <div class=\"login100-form\">\r\n");
      out.write("                          <label for=\"days\">No of days</label>\r\n");
      out.write("                          <input type=\"number\" class=\"input100\" name=\"days\" id=\"days\" max=\"21\" min=\"0\" required >\r\n");
      out.write("                        </div>\r\n");
      out.write("                       \r\n");
      out.write("                        \r\n");
      out.write("                        <div class=\"login100-form\">\r\n");
      out.write("                          <label for=\"startDate\">Start Date:</label>\r\n");
      out.write("                          <input type=\"date\" class=\"input100\" name=\"startDate\" id=\"startDate\" placeholder=\"Start Date\" required>\r\n");
      out.write("                        </div> \r\n");
      out.write("                        \r\n");
      out.write("                        <div class=\"login100-form\">\r\n");
      out.write("                          <label for=\"endDate\">End Date:</label>\r\n");
      out.write("                          <input class=\"input100\" name=\"endDate\" id=\"endDate\" placeholder=\"End Date\" readonly required>\r\n");
      out.write("                        </div>\r\n");
      out.write("                        <br>\r\n");
      out.write("                        <center>\r\n");
      out.write("                              <button type=\"submit\" class=\"login100-form-btn\">Apply</button>\r\n");
      out.write("                        </center>\r\n");
      out.write("                    </form>\r\n");
      out.write("                        <br>\r\n");
      out.write("                        <center>\r\n");
      out.write("                            <a href=\"home.jsp\">\r\n");
      out.write("                                <button type=\"submit\" class=\"login100-form-btn\">Cancel Application</button>\r\n");
      out.write("                            </a>\r\n");
      out.write("                        </center>\r\n");
      out.write("                </div>\r\n");
      out.write("        \r\n");
      out.write("            </div>\r\n");
      out.write("        </div>\r\n");
      out.write("<!--Ensure startDate is not a weekend or a Holiday-->\r\n");
      out.write("<script>\r\n");
      out.write("      const picker=document.getElementById('startDate');\r\n");
      out.write("       picker.addEventListener('input', function(e){\r\n");
      out.write("           var hol=[new Date('06/01/2021 03:00:00').getTime(),\r\n");
      out.write("               new Date('01/01/2021 03:00:00').getTime(),\r\n");
      out.write("               new Date('05/01/2021 03:00:00').getTime(),\r\n");
      out.write("               new Date('10/10/2021 03:00:00').getTime(),\r\n");
      out.write("               new Date('12/12/2020 03:00:00').getTime(),\r\n");
      out.write("               new Date('10/20/2020 03:00:00').getTime(),\r\n");
      out.write("               new Date('12/25/2020 03:00:00').getTime(),\r\n");
      out.write("               new Date('12/26/2020 03:00:00').getTime()];\r\n");
      out.write("           var date=new Date(this.value).getTime();\r\n");
      out.write("           for(i=0; i<hol.length; i++){\r\n");
      out.write("                if(hol[i]===date){\r\n");
      out.write("                   e.preventDefault();\r\n");
      out.write("                   this.value='';\r\n");
      out.write("                alert('You can not start your Leave on a Holiday!!!');\r\n");
      out.write("            console.log(hol[i]);\r\n");
      out.write("            console.log(i);\r\n");
      out.write("            console.log(date);\r\n");
      out.write("               }\r\n");
      out.write("           }           \r\n");
      out.write("    \r\n");
      out.write("       })\r\n");
      out.write("||\r\n");
      out.write("       picker.addEventListener('input', function(e){\r\n");
      out.write("           var day=new Date(this.value).getUTCDay();\r\n");
      out.write("           if([6,0].includes(day)){                 //Day 0 represents Sunday && day 6 represents Saturday\r\n");
      out.write("               e.preventDefault();\r\n");
      out.write("               this.value='';\r\n");
      out.write("               alert('You can not start your Leave on a Weekend!!!');\r\n");
      out.write("           }       \r\n");
      out.write("\r\n");
      out.write("       })\r\n");
      out.write("||\r\n");
      out.write("       picker.addEventListener('input', function(e){\r\n");
      out.write("           var date1=new Date(this.value).getTime();\r\n");
      out.write("           var date2=new Date().getTime();      //Today's date\r\n");
      out.write("           if(date1<date2){                 \r\n");
      out.write("               e.preventDefault();\r\n");
      out.write("               this.value='';\r\n");
      out.write("               alert('You cannot choose a past date!!!');\r\n");
      out.write("           }       \r\n");
      out.write("\r\n");
      out.write("       });           \r\n");
      out.write("</script>\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("<!--<script>\r\n");
      out.write("Jquery disable dates on datePicker\r\n");
      out.write("    var hol=[\"2020-07-31\", \"2020-08-05\"];\r\n");
      out.write("       $(\"#startDate\").datepicker({\r\n");
      out.write("           beforeShowDay: function(date){\r\n");
      out.write("               var datestring=jQuery.datepicker.formatDate('yy-mm-dd', date);\r\n");
      out.write("               return[hol.indexOf(datestring)===-1];\r\n");
      out.write("           }\r\n");
      out.write("       });\r\n");
      out.write("    </script>--> \r\n");
      out.write("    \r\n");
      out.write(" <!--Set Days for LeaveType, maternity is 90 days, paternity is 2weeks-->                             \r\n");
      out.write("<script>\r\n");
      out.write("            document.getElementById('leaveType').addEventListener(\"change\", function() {\r\n");
      out.write("var leaveType1=document.getElementById('leaveType').value;\r\n");
      out.write("                if(leaveType1===\"Maternity\"){\r\n");
      out.write("                  var input=$('<input/>',{'type':'number','class':'input100','name':'days', 'id':'days',\r\n");
      out.write("                        'value':'60', 'readonly':''});\r\n");
      out.write("                  $(document.getElementById('days')).replaceWith(input);\r\n");
      out.write("                }\r\n");
      out.write("\t\telse if(leaveType1===\"Sick\"){\r\n");
      out.write("\t\t\tvar input1=$('<input/>',{'type':'number','class':'input100','name':'days', 'id':'days',\r\n");
      out.write("                        'min':'1', 'required':''});\r\n");
      out.write("                  $(document.getElementById('days')).replaceWith(input1);\r\n");
      out.write("                  \r\n");
      out.write("                }\r\n");
      out.write("                else if(leaveType1===\"Paternity\"){\r\n");
      out.write("\t\t\tvar input2=$('<input/>',{'type':'number','class':'input100','name':'days', 'id':'days',\r\n");
      out.write("                        'value':'10', 'readonly':'' });\r\n");
      out.write("                  $(document.getElementById('days')).replaceWith(input2);\r\n");
      out.write("                }\r\n");
      out.write("                else if(leaveType1===\"Annual\"){\r\n");
      out.write("\t\t\tvar input3=$('<input/>',{'type':'number','class':'input100','name':'days', 'id':'days',\r\n");
      out.write("                         'min':'1', 'required':''});\r\n");
      out.write("                  $(document.getElementById('days')).replaceWith(input3);\r\n");
      out.write("                }\r\n");
      out.write("\t\telse{\r\n");
      out.write("\t\t\tvar input4=$('<input/>',{'type':'number','class':'input100','name':'days', 'id':'days',\r\n");
      out.write("                        'min':'1', 'required':''});\r\n");
      out.write("                  $(document.getElementById('days')).replaceWith(input4);\r\n");
      out.write("\t\t}\r\n");
      out.write("           });\r\n");
      out.write("\t\t\r\n");
      out.write("\r\n");
      out.write("</script>    \r\n");
      out.write("\t\r\n");
      out.write("<!--calculate the end Date ensuring that all weekends and Holidays are excluded and that the end date itself is not on a  or a Holiday    --> \t\r\n");
      out.write("        <script>\r\n");
      out.write("function calcWorkingDays(date, days){\r\n");
      out.write("    var hol1=[['New Year',[1,1]], ['Christmas day', [12,25]], ['Madaraka Day', [6,1]], ['Jamhuri Day', [12,12]], ['Labour Day',[5,1]],['Twins Day',[7,27]], ['Mashujaa Day',[10,20]]];\r\n");
      out.write("    var hol2=['07/30/2020 03:00:00','08/06/2020 03:00:00'];\r\n");
      out.write("    var hol=['01/01/2021 03:00:00', '05/01/2021 03:00:00','06/01/2021 03:00:00','10/10/2021 03:00:00','12/12/2020 03:00:00','10/20/2020 03:00:00',\r\n");
      out.write("        '12/25/2020 03:00:00','12/26/2020 03:00:00'];\r\n");
      out.write("    var count=0;\r\n");
      out.write("    while(count < days){\r\n");
      out.write("        date.setDate(date.getDate()+1);\r\n");
      out.write("        date1=new Date(date).getUTCDay();\r\n");
      out.write("        //Day 0 represents Sunday && day 6 represents Saturday\r\n");
      out.write("        if(date1!==0 && date1!==6 && !isHoliday(date,hol)){\r\n");
      out.write("            count++;\r\n");
      out.write("        }\r\n");
      out.write("        function isHoliday(date,arr){\r\n");
      out.write("            var bln;\r\n");
      out.write("            date2=new Date(date).getTime();\r\n");
      out.write("            for(var i=0; i<arr.length; i++){  \r\n");
      out.write("                date3=new Date(hol[i]).getTime();\r\n");
      out.write("                if(date2===date3){\r\n");
      out.write("                    bln=true;\r\n");
      out.write("                    break;\r\n");
      out.write("                }  \r\n");
      out.write("                else{\r\n");
      out.write("                    bln=false;\r\n");
      out.write("                }\r\n");
      out.write("             \r\n");
      out.write("              console.log(date.toLocaleDateString('en-US'));\r\n");
      out.write("              console.log(date.toLocaleString());\r\n");
      out.write("              console.log(date.toISOString().split('T')[0]);\r\n");
      out.write("              console.log(hol[i]); \r\n");
      out.write("              console.log(bln);\r\n");
      out.write("            }\r\n");
      out.write("            return bln;\r\n");
      out.write("    }\r\n");
      out.write("    }\r\n");
      out.write("    return date.toISOString().split('T')[0];\r\n");
      out.write("} \r\n");
      out.write("document.getElementById(\"leaveType\").addEventListener(\"change\", function(){\r\n");
      out.write("        var startDate=document.getElementById(\"startDate\").value;\r\n");
      out.write("        var days=document.getElementById(\"days\").value;\r\n");
      out.write("    document.getElementById(\"endDate\").value=(calcWorkingDays(new Date(startDate), days));\r\n");
      out.write("    })\r\n");
      out.write("||\r\n");
      out.write("document.getElementById(\"days\").addEventListener(\"change\", function(){\r\n");
      out.write("        var startDate=document.getElementById(\"startDate\").value;\r\n");
      out.write("        var days=document.getElementById(\"days\").value;\r\n");
      out.write("    document.getElementById(\"endDate\").value=(calcWorkingDays(new Date(startDate), days));\r\n");
      out.write("    })\r\n");
      out.write("||\r\n");
      out.write("document.getElementById(\"startDate\").addEventListener(\"change\", function(){\r\n");
      out.write("        var startDate=document.getElementById(\"startDate\").value;\r\n");
      out.write("        var days=document.getElementById(\"days\").value;\r\n");
      out.write("    document.getElementById(\"endDate\").value=(calcWorkingDays(new Date(startDate), days));\r\n");
      out.write("    });\r\n");
      out.write("            </script>\r\n");
      out.write("<!--            \r\n");
      out.write(" ||\r\n");
      out.write("date.setDate(date.getDate()+1);\r\n");
      out.write("        date1=new Date(date).getTime();\r\n");
      out.write("        var i=0;\r\n");
      out.write("        while(i<hol.length){ \r\n");
      out.write("            if(hol[i]!==date1){\r\n");
      out.write("            console.log(hol[i]);\r\n");
      out.write("            console.log(i);\r\n");
      out.write("            console.log(date1);\r\n");
      out.write("            i++;\r\n");
      out.write("            }\r\n");
      out.write("            i=10;\r\n");
      out.write("         }\r\n");
      out.write("      count++; \r\n");
      out.write(" \r\n");
      out.write("document.getElementById(\"days\").addEventListener(\"change\", function(){\r\n");
      out.write("    var startDate=document.getElementById(\"startDate\").value;\r\n");
      out.write("    var days=document.getElementById(\"days\").value;\r\n");
      out.write("    var date1=new Date(startDate);\r\n");
      out.write("var diff=days*(1000*3600*24);\r\n");
      out.write("var diff2=date1.getTime()+diff;\r\n");
      out.write("document.getElementById(\"endDate\").value= new Date(diff2);\r\n");
      out.write(" })\r\n");
      out.write(" ||\r\n");
      out.write(" document.getElementById(\"leaveType\").addEventListener(\"change\", function(){\r\n");
      out.write("    var startDate=document.getElementById(\"startDate\").value;\r\n");
      out.write("    var days=document.getElementById(\"days\").value;\r\n");
      out.write("    var date1=new Date(startDate);\r\n");
      out.write("var diff=days*(1000*3600*24);\r\n");
      out.write("var diff2=date1.getTime()+diff;\r\n");
      out.write("document.getElementById(\"endDate\").value= new Date(diff2);\r\n");
      out.write(" });\r\n");
      out.write("</script>\r\n");
      out.write("-->\r\n");
      out.write("\r\n");
      out.write("\t\r\n");
      out.write("    <!-- Optional JavaScript -->\r\n");
      out.write("    <!-- jQuery first, then Popper.js, then Bootstrap JS -->\r\n");
      out.write("  </body>\r\n");
      out.write("</html>\r\n");
    } catch (Throwable t) {
      if (!(t instanceof SkipPageException)){
        out = _jspx_out;
        if (out != null && out.getBufferSize() != 0)
          out.clearBuffer();
        if (_jspx_page_context != null) _jspx_page_context.handlePageException(t);
        else throw new ServletException(t);
      }
    } finally {
      _jspxFactory.releasePageContext(_jspx_page_context);
    }
  }
}
