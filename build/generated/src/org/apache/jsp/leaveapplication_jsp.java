package org.apache.jsp;

import javax.servlet.*;
import javax.servlet.http.*;
import javax.servlet.jsp.*;
import org.evamay.business.Staff;
import java.sql.*;

public final class leaveapplication_jsp extends org.apache.jasper.runtime.HttpJspBase
    implements org.apache.jasper.runtime.JspSourceDependent {

  private static final JspFactory _jspxFactory = JspFactory.getDefaultFactory();

  private static java.util.List<String> _jspx_dependants;

  private org.glassfish.jsp.api.ResourceInjector _jspx_resourceInjector;

  public java.util.List<String> getDependants() {
    return _jspx_dependants;
  }

  public void _jspService(HttpServletRequest request, HttpServletResponse response)
        throws java.io.IOException, ServletException {

    PageContext pageContext = null;
    HttpSession session = null;
    ServletContext application = null;
    ServletConfig config = null;
    JspWriter out = null;
    Object page = this;
    JspWriter _jspx_out = null;
    PageContext _jspx_page_context = null;

    try {
      response.setContentType("text/html;charset=UTF-8");
      pageContext = _jspxFactory.getPageContext(this, request, response,
      			null, true, 8192, true);
      _jspx_page_context = pageContext;
      application = pageContext.getServletContext();
      config = pageContext.getServletConfig();
      session = pageContext.getSession();
      out = pageContext.getOut();
      _jspx_out = out;
      _jspx_resourceInjector = (org.glassfish.jsp.api.ResourceInjector) application.getAttribute("com.sun.appserv.jsp.resource.injector");

      out.write("\n");
      out.write("\n");
      out.write("\n");
      out.write("\n");
      out.write("\n");
      out.write("\n");
      out.write("<!DOCTYPE html>\n");
      out.write("<html lang=\"en\">\n");
      out.write("    <head>\n");
      out.write("\t<title>EvaMay Technologies</title>\n");
      out.write("\t<meta charset=\"UTF-8\">\n");
      out.write("\t<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\t\n");
      out.write("\t<link rel=\"icon\" type=\"image/png\" href=\"images/logo2.png\"/>\n");
      out.write("\t\n");
      out.write("\t<link rel=\"stylesheet\" type=\"text/css\" href=\"css/util.css\">\n");
      out.write("\t<link rel=\"stylesheet\" type=\"text/css\" href=\"css/main.css\">\n");
      out.write("        <script src=\"js/jquery-3.5.1.js\"></script>\n");
      out.write("        <script src=\"js/jquery-ui.js\"></script>\n");
      out.write("\n");
      out.write("            <style>\n");
      out.write(".hide {\n");
      out.write("  display: none\n");
      out.write("}\n");
      out.write("</style>\n");
      out.write("    </head>\n");
      out.write("\n");
      out.write("    <body>\n");
      out.write("        \n");
      out.write("\t<div class=\"limiter\">\n");
      out.write("            <div class=\"container-login100\" style=\"background-image: url('images/office2.jpg');\">\n");
      out.write("\t\t<div class=\"wrap-login100\">\n");
      out.write("                    <form class=\"login100-form validate-form\" method=\"post\" action=\"ApplyLeaveServlet\" name=\"login_form\" id=\"login_form\">\n");
      out.write("\t\t\t<span class=\"login100-form-logo\">\n");
      out.write("                            <img src='images/logo2.png' alt='logo' width=\"200%\" height=\"100%\">\n");
      out.write("\t\t\t</span>\n");
      out.write("                        <span class=\"login100-form-title p-b-34 p-t-27\">\n");
      out.write("                            Leave application\n");
      out.write("\t\t\t</span>\n");
      out.write("                        \n");
      out.write("                        <div class=\"login100-form\">\n");
      out.write("                         <input type=\"text\" name=\"staffId\" id=\"staffId\" value=\"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.evaluateExpression("${staff.staffId}", java.lang.String.class, (PageContext)_jspx_page_context, null));
      out.write("\">\n");
      out.write("                         <input type=\"text\" name=\"status\" id=\"status\" value=\"pending\">  \n");
      out.write("                         <input type=\"text\" name=\"remainingDays\" id=\"remainingDays\" value=\"10\">\n");
      out.write("                         <input type=\"text\" name=\"gender\" id=\"gender\" value=\"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.evaluateExpression("${staff.gender}", java.lang.String.class, (PageContext)_jspx_page_context, null));
      out.write("\">\n");
      out.write("                        </div> \n");
      out.write("                        ");

            Staff staff=(Staff)session.getAttribute("staff");
            String gender=staff.getGender();
            String gender1="Male";
            System.out.println(staff.getGender());
            System.out.println(gender);
            System.out.println(gender1);
            if(gender==gender1){
            
      out.write("\n");
      out.write("\t\t\t<div class=\"login100-form\">\n");
      out.write("                            <label for=\"leaveType\">Leave Type:</label>\n");
      out.write("                            <select class=\"input100\" id=\"leaveType\" name=\"leaveType\">\n");
      out.write("                                <option>Annual</option>\n");
      out.write("                                <option>Sick</option>\n");
      out.write("                                <option>Paternity</option>\n");
      out.write("                                <option>Others</option>\n");
      out.write("                            </select>\n");
      out.write("                        </div>\n");
      out.write("            ");

            }else{
              
      out.write(" \n");
      out.write("              <div class=\"login100-form\">\n");
      out.write("                  <input type=\"text\" name=\"gender\" id=\"gender\" value=\"");
      out.print(staff.getGender());
      out.write("\">\n");
      out.write("                            <label for=\"leaveType\">Leave Type:</label>\n");
      out.write("                            <select class=\"input100\" id=\"leaveType\" name=\"leaveType\">\n");
      out.write("                                <option>Annual</option>\n");
      out.write("                                <option>Sick</option>\n");
      out.write("                                <option>Maternity</option>\n");
      out.write("                                <option>Others</option>\n");
      out.write("                            </select>\n");
      out.write("                        </div>\n");
      out.write("               ");

            }
              
      out.write("  \n");
      out.write("                        <div class=\"login100-form\">\n");
      out.write("                          <label for=\"days\">No of days</label>\n");
      out.write("                          <input type=\"number\" class=\"input100\" name=\"days\" id=\"days\" max=\"21\" min=\"0\" required >\n");
      out.write("                        </div>\n");
      out.write("                       \n");
      out.write("                        \n");
      out.write("                        <div class=\"login100-form\">\n");
      out.write("                          <label for=\"startDate\">Start Date:</label>\n");
      out.write("                          <input type=\"date\" class=\"input100\" name=\"startDate\" id=\"startDate\" placeholder=\"Start Date\" required>\n");
      out.write("                        </div> \n");
      out.write("                        \n");
      out.write("                        <div class=\"login100-form\">\n");
      out.write("                          <label for=\"endDate\">End Date:</label>\n");
      out.write("                          <input class=\"input100\" name=\"endDate\" id=\"endDate\" placeholder=\"End Date\" readonly required>\n");
      out.write("                        </div>\n");
      out.write("                        <br>\n");
      out.write("                        <center>\n");
      out.write("                              <button type=\"submit\" class=\"login100-form-btn\">Apply</button>\n");
      out.write("                        </center>\n");
      out.write("                    </form>\n");
      out.write("                        <br>\n");
      out.write("                        <center>\n");
      out.write("                            <a href=\"home.jsp\">\n");
      out.write("                                <button type=\"submit\" class=\"login100-form-btn\">Cancel Application</button>\n");
      out.write("                            </a>\n");
      out.write("                        </center>\n");
      out.write("                </div>\n");
      out.write("        \n");
      out.write("            </div>\n");
      out.write("        </div>\n");
      out.write("<!--Ensure startDate is not a weekend or a Holiday-->\n");
      out.write("<script>\n");
      out.write("      const picker=document.getElementById('startDate');\n");
      out.write("       picker.addEventListener('input', function(e){\n");
      out.write("           var hol=[new Date('06/01/2021 03:00:00').getTime(),\n");
      out.write("               new Date('01/01/2021 03:00:00').getTime(),\n");
      out.write("               new Date('05/01/2021 03:00:00').getTime(),\n");
      out.write("               new Date('10/10/2021 03:00:00').getTime(),\n");
      out.write("               new Date('12/12/2020 03:00:00').getTime(),\n");
      out.write("               new Date('10/20/2020 03:00:00').getTime(),\n");
      out.write("               new Date('12/25/2020 03:00:00').getTime(),\n");
      out.write("               new Date('12/26/2020 03:00:00').getTime()];\n");
      out.write("           var date=new Date(this.value).getTime();\n");
      out.write("           for(i=0; i<hol.length; i++){\n");
      out.write("                if(hol[i]===date){\n");
      out.write("                   e.preventDefault();\n");
      out.write("                   this.value='';\n");
      out.write("                alert('You can not start your Leave on a Holiday!!!');\n");
      out.write("            console.log(hol[i]);\n");
      out.write("            console.log(i);\n");
      out.write("            console.log(date);\n");
      out.write("               }\n");
      out.write("           }           \n");
      out.write("    \n");
      out.write("       })\n");
      out.write("||\n");
      out.write("       picker.addEventListener('input', function(e){\n");
      out.write("           var day=new Date(this.value).getUTCDay();\n");
      out.write("           if([6,0].includes(day)){                 //Day 0 represents Sunday && day 6 represents Saturday\n");
      out.write("               e.preventDefault();\n");
      out.write("               this.value='';\n");
      out.write("               alert('You can not start your Leave on a Weekend!!!');\n");
      out.write("           }       \n");
      out.write("\n");
      out.write("       })\n");
      out.write("||\n");
      out.write("       picker.addEventListener('input', function(e){\n");
      out.write("           var date1=new Date(this.value).getTime();\n");
      out.write("           var date2=new Date().getTime();      //Today's date\n");
      out.write("           if(date1<date2){                 \n");
      out.write("               e.preventDefault();\n");
      out.write("               this.value='';\n");
      out.write("               alert('You cannot choose a past date!!!');\n");
      out.write("           }       \n");
      out.write("\n");
      out.write("       });           \n");
      out.write("</script>\n");
      out.write("\n");
      out.write("\n");
      out.write("\n");
      out.write("<!--<script>\n");
      out.write("Jquery disable dates on datePicker\n");
      out.write("    var hol=[\"2020-07-31\", \"2020-08-05\"];\n");
      out.write("       $(\"#startDate\").datepicker({\n");
      out.write("           beforeShowDay: function(date){\n");
      out.write("               var datestring=jQuery.datepicker.formatDate('yy-mm-dd', date);\n");
      out.write("               return[hol.indexOf(datestring)===-1];\n");
      out.write("           }\n");
      out.write("       });\n");
      out.write("    </script>--> \n");
      out.write("    \n");
      out.write(" <!--Set Days for LeaveType, maternity is 90 days, paternity is 2weeks-->                             \n");
      out.write("<script>\n");
      out.write("            document.getElementById('leaveType').addEventListener(\"change\", function() {\n");
      out.write("var leaveType1=document.getElementById('leaveType').value;\n");
      out.write("                if(leaveType1===\"Maternity\"){\n");
      out.write("                  var input=$('<input/>',{'type':'number','class':'input100','name':'days', 'id':'days',\n");
      out.write("                        'value':'60', 'readonly':''});\n");
      out.write("                  $(document.getElementById('days')).replaceWith(input);\n");
      out.write("                }\n");
      out.write("\t\telse if(leaveType1===\"Sick\"){\n");
      out.write("\t\t\tvar input1=$('<input/>',{'type':'number','class':'input100','name':'days', 'id':'days',\n");
      out.write("                        'min':'1', 'required':''});\n");
      out.write("                  $(document.getElementById('days')).replaceWith(input1);\n");
      out.write("                  \n");
      out.write("                }\n");
      out.write("                else if(leaveType1===\"Paternity\"){\n");
      out.write("\t\t\tvar input2=$('<input/>',{'type':'number','class':'input100','name':'days', 'id':'days',\n");
      out.write("                        'value':'10', 'readonly':'' });\n");
      out.write("                  $(document.getElementById('days')).replaceWith(input2);\n");
      out.write("                }\n");
      out.write("                else if(leaveType1===\"Annual\"){\n");
      out.write("\t\t\tvar input3=$('<input/>',{'type':'number','class':'input100','name':'days', 'id':'days',\n");
      out.write("                         'min':'1', 'required':''});\n");
      out.write("                  $(document.getElementById('days')).replaceWith(input3);\n");
      out.write("                }\n");
      out.write("\t\telse{\n");
      out.write("\t\t\tvar input4=$('<input/>',{'type':'number','class':'input100','name':'days', 'id':'days',\n");
      out.write("                        'min':'1', 'required':''});\n");
      out.write("                  $(document.getElementById('days')).replaceWith(input4);\n");
      out.write("\t\t}\n");
      out.write("           });\n");
      out.write("\t\t\n");
      out.write("\n");
      out.write("</script>    \n");
      out.write("\t\n");
      out.write("<!--calculate the end Date ensuring that all weekends and Holidays are excluded and that the end date itself is not on a  or a Holiday    --> \t\n");
      out.write("        <script>\n");
      out.write("function calcWorkingDays(date, days){\n");
      out.write("    var hol1=[['New Year',[1,1]], ['Christmas day', [12,25]], ['Madaraka Day', [6,1]], ['Jamhuri Day', [12,12]], ['Labour Day',[5,1]],['Twins Day',[7,27]], ['Mashujaa Day',[10,20]]];\n");
      out.write("    var hol2=['07/30/2020 03:00:00','08/06/2020 03:00:00'];\n");
      out.write("    var hol=['01/01/2021 03:00:00', '05/01/2021 03:00:00','06/01/2021 03:00:00','10/10/2021 03:00:00','12/12/2020 03:00:00','10/20/2020 03:00:00',\n");
      out.write("        '12/25/2020 03:00:00','12/26/2020 03:00:00'];\n");
      out.write("    var count=0;\n");
      out.write("    while(count < days){\n");
      out.write("        date.setDate(date.getDate()+1);\n");
      out.write("        date1=new Date(date).getUTCDay();\n");
      out.write("        //Day 0 represents Sunday && day 6 represents Saturday\n");
      out.write("        if(date1!==0 && date1!==6 && !isHoliday(date,hol)){\n");
      out.write("            count++;\n");
      out.write("        }\n");
      out.write("        function isHoliday(date,arr){\n");
      out.write("            var bln;\n");
      out.write("            date2=new Date(date).getTime();\n");
      out.write("            for(var i=0; i<arr.length; i++){  \n");
      out.write("                date3=new Date(hol[i]).getTime();\n");
      out.write("                if(date2===date3){\n");
      out.write("                    bln=true;\n");
      out.write("                    break;\n");
      out.write("                }  \n");
      out.write("                else{\n");
      out.write("                    bln=false;\n");
      out.write("                }\n");
      out.write("             \n");
      out.write("              console.log(date.toLocaleDateString('en-US'));\n");
      out.write("              console.log(date.toLocaleString());\n");
      out.write("              console.log(date.toISOString().split('T')[0]);\n");
      out.write("              console.log(hol[i]); \n");
      out.write("              console.log(bln);\n");
      out.write("            }\n");
      out.write("            return bln;\n");
      out.write("    }\n");
      out.write("    }\n");
      out.write("    return date.toISOString().split('T')[0];\n");
      out.write("} \n");
      out.write("document.getElementById(\"leaveType\").addEventListener(\"change\", function(){\n");
      out.write("        var startDate=document.getElementById(\"startDate\").value;\n");
      out.write("        var days=document.getElementById(\"days\").value;\n");
      out.write("    document.getElementById(\"endDate\").value=(calcWorkingDays(new Date(startDate), days));\n");
      out.write("    })\n");
      out.write("||\n");
      out.write("document.getElementById(\"days\").addEventListener(\"change\", function(){\n");
      out.write("        var startDate=document.getElementById(\"startDate\").value;\n");
      out.write("        var days=document.getElementById(\"days\").value;\n");
      out.write("    document.getElementById(\"endDate\").value=(calcWorkingDays(new Date(startDate), days));\n");
      out.write("    })\n");
      out.write("||\n");
      out.write("document.getElementById(\"startDate\").addEventListener(\"change\", function(){\n");
      out.write("        var startDate=document.getElementById(\"startDate\").value;\n");
      out.write("        var days=document.getElementById(\"days\").value;\n");
      out.write("    document.getElementById(\"endDate\").value=(calcWorkingDays(new Date(startDate), days));\n");
      out.write("    });\n");
      out.write("            </script>\n");
      out.write("<!--            \n");
      out.write(" ||\n");
      out.write("date.setDate(date.getDate()+1);\n");
      out.write("        date1=new Date(date).getTime();\n");
      out.write("        var i=0;\n");
      out.write("        while(i<hol.length){ \n");
      out.write("            if(hol[i]!==date1){\n");
      out.write("            console.log(hol[i]);\n");
      out.write("            console.log(i);\n");
      out.write("            console.log(date1);\n");
      out.write("            i++;\n");
      out.write("            }\n");
      out.write("            i=10;\n");
      out.write("         }\n");
      out.write("      count++; \n");
      out.write(" \n");
      out.write("document.getElementById(\"days\").addEventListener(\"change\", function(){\n");
      out.write("    var startDate=document.getElementById(\"startDate\").value;\n");
      out.write("    var days=document.getElementById(\"days\").value;\n");
      out.write("    var date1=new Date(startDate);\n");
      out.write("var diff=days*(1000*3600*24);\n");
      out.write("var diff2=date1.getTime()+diff;\n");
      out.write("document.getElementById(\"endDate\").value= new Date(diff2);\n");
      out.write(" })\n");
      out.write(" ||\n");
      out.write(" document.getElementById(\"leaveType\").addEventListener(\"change\", function(){\n");
      out.write("    var startDate=document.getElementById(\"startDate\").value;\n");
      out.write("    var days=document.getElementById(\"days\").value;\n");
      out.write("    var date1=new Date(startDate);\n");
      out.write("var diff=days*(1000*3600*24);\n");
      out.write("var diff2=date1.getTime()+diff;\n");
      out.write("document.getElementById(\"endDate\").value= new Date(diff2);\n");
      out.write(" });\n");
      out.write("</script>\n");
      out.write("-->\n");
      out.write("\n");
      out.write("\t\n");
      out.write("    <!-- Optional JavaScript -->\n");
      out.write("    <!-- jQuery first, then Popper.js, then Bootstrap JS -->\n");
      out.write("  </body>\n");
      out.write("</html>\n");
    } catch (Throwable t) {
      if (!(t instanceof SkipPageException)){
        out = _jspx_out;
        if (out != null && out.getBufferSize() != 0)
          out.clearBuffer();
        if (_jspx_page_context != null) _jspx_page_context.handlePageException(t);
        else throw new ServletException(t);
      }
    } finally {
      _jspxFactory.releasePageContext(_jspx_page_context);
    }
  }
}
